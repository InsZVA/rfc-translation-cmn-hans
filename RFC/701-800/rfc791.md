RFC 791 网际协议
========

目录
--------

+ [x] 1 [介绍](#1-介绍)
  - [x] 1.1 [动机](#11-动机)
  - [x] 1.2 [范围](#12-范围)
  - [x] 1.3 [接口](#13-接口)
  - [x] 1.4 [操作](#14-操作)
+ [ ] 2 [概览](#2-概览)
  - [x] 2.1 [与其他协议的联系](#21-与其他协议的联系)
  - [ ] 2.2 [操作模型](#22-操作模型)
  - [ ] 2.3 [功能描述](#23-功能描述)
  - [ ] 2.4 [网关](#24-网关)
+ [ ] 3 [规范](#3-规范)
  - [ ] 3.1 [网际头部格式](#31-网际头部格式)
  - [ ] 3.2 [讨论](#32-讨论)
  - [ ] 3.3 [接口](#33-接口)
+ [ ] 附录A [范例](#附录a-范例)
+ [ ] 附录B [数据传输顺序](#附录b-数据传输顺序)


1 介绍
--------

### 1.1 动机

网际协议是为包交换计算机通讯网络的互联系统设计的。这样的系统先前被称为“catenet”[1]。网际协议提供从源到目标的数据块传输——这被称为数据报，其中源和目标都由固定长度的地址确定主机。如果需要在“小包”网络中传输，则网际协议也可提供长数据报的分片和重组。

### 1.2 范围

网际协议仅限于提供通过网络互联系统从源到目标传输位包（网际数据报）所需的功能。它没有增强端到端数据可靠性、流控制、排序的机制，或者其他常见的主机到主机的协议的功能。网际协议可以利用其支持网络的服务来提供不同类型和质量的服务。

### 1.3 接口

本协议由互联网环境中的主机到主机的协议调用。本协议调用本地网络协议，用于将网际数据报带往下一个网关或目标主机。

例如，TCP模块会调用网际模块并将一个TCP分片（包含TCP头部和用户数据）作为网际数据报的数据部分。TCP模块会在网际头部中提供地址及其他作为调用网际模块的参数。随后网际模块会生成一个网际数据报并调用本地网络接口来传输网际数据报。

例如，在ARPANET中，网际模块会调用本地网络模块，而本地网络模块会在网际数据报前添加1822个前导字节[2]来创建一条发送给IMP的ARPANET信息。本地网络接口会从IP地址中获取APRANET地址，这个地址为ARPANET中某些主机的地址，且这些主机可能为通向其他网络的网关。

### 1.4 操作

网际协议实现了两个基本功能：寻址和分片。

IP模块使用存放于网际头部的地址将网际数据报发送至目标。传输路径的选择被称为路由。

当需要在“小包”网络中传输时，IP模块使用网际头部中的域来分片或重组网际数据报。

操作模型是指驻留在每一个进行互联网通信的主机和连接网络的网关中的IP模块。这些模块共享相同的解释地址域以及分片及重组网际数据报的规则。此外，这些模块（特别是网关）拥有进行路由决策和其他功能的程序。

网际协议将每一个网际数据报作为独立的实体，且与其他网际数据报无关。它没有连接或逻辑回路（虚拟或其他的）。

网际协议使用四个主要机制来提供它的服务：服务类型、生存时间、选项和头部校验和。

服务类型用于表明期望的服务质量。服务类型是抽象或普遍的参数集合，这些参数描述了组成互联网的网络中提供的服务选择。服务类型标示会在路由网际数据报时被网关用于选择特定网络的传输参数，下一跳（？）的网络，或下一个网关。

生存时间用于表明网际数据报的最大生存时间。它由发送者设置，且每次被路由处理时减少。如果生存时间在网际数据报达到目标前达到0，则这个网际数据报将被摧毁。生存时间可被看做自我销毁时间限制。

选项提供了在某些情况下有用但在大多数通常通讯中不需要的控制功能。选项包含提供时间戳、安全和特殊路由。

头部校验和提供了用于处理网际数据报是否被正确发送的验证。数据可能包含错误。如果头部校验和出错，则网际数据报将立即被检测到错误的实体丢弃。

网际协议不提供可靠的通讯机制。它没有端到端或逐跳（？）的确认机制。它没有数据的错误控制，只有头部校验和。它没有重传机制。它也没有流控制。

错误检测可以通过互联网控制消息协议（ICMP）[3]报告，它被实现在IP模块中。


2 概览
--------

### 2.1 与其他协议的联系

下图说明了网际协议在协议分层中的位置：

    +------+ +-----+ +-----+     +-----+
    |Telnet| | FTP | | TFTP| ... | ... |
    +------+ +-----+ +-----+     +-----+
          |   |         |           |
         +-----+     +-----+     +-----+
         | TCP |     | UDP | ... | ... |
         +-----+     +-----+     +-----+
            |           |           |
         +--------------------------+----+
         |    Internet Protocol & ICMP   |
         +--------------------------+----+
                        |
           +---------------------------+
           |   Local Network Protocol  |
           +---------------------------+

图1 协议关系

网际协议的接口一边是更高级别的主机到主机的协议，另一边是本地网络协议。在这个上下文中“本地网络”可以是一栋建筑中的小网络，或是像ARPANET这样的大网络。

### 2.2 操作模型

### 2.3 功能描述

### 2.4 网关

网关实现网际协议来在网络间传递数据报。网关也实现了网关对网关协议（GGP）[7]来协调路由和其他网际控制信息。

在网关中不必实现更高级别的协议，且GGP功能会被附加到IP模块中。

      +-------------------------------+
      | Internet Protocol & ICMP & GGP|
      +-------------------------------+
              |                 |
    +---------------+   +---------------+
    |   Local Net   |   |   Local Net   |
    +---------------+   +---------------+

图3 网关协议


3 规范
--------

### 3.1 网际头部格式

### 3.2 讨论

### 3.3 接口


附录A 范例
--------


附录B 数据传输顺序
--------
